<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="åŸå¸‚è¡—é“ä½é¾„å„¿ç«¥æ˜“å¤±è¸ªç©ºé—´é£é™©æ„ŸçŸ¥ç ”ç©¶å¹³å°">
    <title>åŸå¸‚ç©ºé—´å®‰å…¨æ„ŸçŸ¥ç ”ç©¶å¹³å°</title>
    
    <!-- LeanCloud SDK -->
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.2/dist/av-min.js"></script>
    
    <style>
        /* ==================== å…¨å±€æ ·å¼ ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            /* ä¼˜é›…çš„è‰²å½©ç³»ç»Ÿ */
            --primary-color: #2C3E50;        /* æ·±è“ç° - ä¸“ä¸šæ„Ÿ */
            --secondary-color: #3498DB;      /* æ˜äº®è“ - å¼ºè°ƒè‰² */
            --accent-color: #E8F4F8;         /* æµ…è“ - èƒŒæ™¯è‰² */
            --text-primary: #2C3E50;         /* ä¸»æ–‡æœ¬ */
            --text-secondary: #7F8C8D;       /* æ¬¡è¦æ–‡æœ¬ */
            --border-color: #E0E6ED;         /* è¾¹æ¡†è‰² */
            --success-color: #27AE60;        /* æˆåŠŸç»¿ */
            --warning-color: #F39C12;        /* è­¦å‘Šæ©™ */
            --bg-white: #FFFFFF;
            --bg-light: #F8FAFB;
            
            /* é—´è·ç³»ç»Ÿ */
            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;
            
            /* é˜´å½±ç³»ç»Ÿ */
            --shadow-sm: 0 2px 8px rgba(44, 62, 80, 0.08);
            --shadow-md: 0 4px 16px rgba(44, 62, 80, 0.12);
            --shadow-lg: 0 8px 32px rgba(44, 62, 80, 0.16);
            
            /* åœ†è§’ */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            
            /* è¿‡æ¸¡ */
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 
                         'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* ==================== å®¹å™¨å¸ƒå±€ ==================== */
        #app {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--spacing-md);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .page {
            display: none;
            width: 100%;
            background: var(--bg-white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            padding: var(--spacing-xl);
            animation: fadeIn 0.4s ease;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* ==================== Logo å’Œå¤´éƒ¨ ==================== */
        .page-header {
            text-align: center;
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-lg);
            border-bottom: 2px solid var(--accent-color);
        }
        
        .logo {
            width: 80px;
            height: 80px;
            margin: 0 auto var(--spacing-md);
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            box-shadow: var(--shadow-md);
        }
        
        .page-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: var(--spacing-sm);
            letter-spacing: -0.5px;
        }
        
        .page-subtitle {
            font-size: 0.95rem;
            color: var(--text-secondary);
            font-weight: 400;
        }
        
        /* ==================== å†…å®¹åŒºåŸŸ ==================== */
        .content {
            margin: var(--spacing-lg) 0;
        }
        
        .content-section {
            margin-bottom: var(--spacing-lg);
            padding: var(--spacing-md);
            background: var(--bg-light);
            border-radius: var(--radius-md);
            border-left: 4px solid var(--secondary-color);
        }
        
        .content-section h3 {
            color: var(--primary-color);
            font-size: 1.1rem;
            margin-bottom: var(--spacing-sm);
            font-weight: 600;
        }
        
        .content-section p, .content-section ul {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.8;
        }
        
        .content-section ul {
            padding-left: var(--spacing-md);
            margin-top: var(--spacing-sm);
        }
        
        .content-section li {
            margin-bottom: var(--spacing-xs);
        }
        
        /* ==================== è¡¨å•æ ·å¼ ==================== */
        .form-group {
            margin-bottom: var(--spacing-md);
        }
        
        .form-label {
            display: block;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
        }
        
        .form-label.required::after {
            content: '*';
            color: #E74C3C;
            margin-left: 4px;
        }
        
        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            font-size: 0.95rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-sm);
            transition: all var(--transition-fast);
            background: var(--bg-white);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .form-control:disabled {
            background: var(--bg-light);
            cursor: not-allowed;
        }
        
        select.form-control {
            cursor: pointer;
        }
        
        textarea.form-control {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }
        
        .char-count {
            text-align: right;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: var(--spacing-xs);
        }
        
        /* ==================== æŒ‰é’®æ ·å¼ ==================== */
        .btn {
            display: inline-block;
            padding: 0.875rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            text-align: center;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition-normal);
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn:active::before {
            width: 300px;
            height: 300px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--secondary-color), #2980B9);
            color: white;
            box-shadow: var(--shadow-sm);
        }
        
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .btn-secondary {
            background: var(--bg-light);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
        }
        
        .btn-secondary:hover:not(:disabled) {
            background: var(--bg-white);
            border-color: var(--secondary-color);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .btn-block {
            width: 100%;
            display: block;
        }
        
        .button-group {
            display: flex;
            gap: var(--spacing-md);
            margin-top: var(--spacing-lg);
        }
        
        .button-group .btn {
            flex: 1;
        }
        
        /* ==================== å›¾ç‰‡æ¯”è¾ƒé¡µé¢ ==================== */
        .progress-bar {
            text-align: center;
            margin-bottom: var(--spacing-lg);
            padding: var(--spacing-md);
            background: var(--accent-color);
            border-radius: var(--radius-md);
        }
        
        .progress-text {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .progress-numbers {
            font-size: 1.5rem;
            color: var(--secondary-color);
        }
        
        .prompt {
            text-align: center;
            font-size: 1.15rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: var(--spacing-lg);
            padding: var(--spacing-md);
            background: var(--bg-light);
            border-radius: var(--radius-md);
        }
        
        .image-container {
            display: flex;
            gap: var(--spacing-lg);
            margin: var(--spacing-lg) 0;
        }
        
        .image-box {
            flex: 1;
            cursor: pointer;
            border-radius: var(--radius-md);
            overflow: hidden;
            border: 3px solid transparent;
            transition: all var(--transition-normal);
            position: relative;
            background: var(--bg-light);
        }
        
        .image-box::after {
            content: 'ç‚¹å‡»é€‰æ‹©';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
            color: white;
            padding: var(--spacing-md);
            text-align: center;
            font-weight: 600;
            opacity: 0;
            transition: opacity var(--transition-normal);
        }
        
        .image-box:hover {
            transform: translateY(-4px);
            border-color: var(--secondary-color);
            box-shadow: var(--shadow-lg);
        }
        
        .image-box:hover::after {
            opacity: 1;
        }
        
        .image-box.disabled {
            pointer-events: none;
            opacity: 0.6;
        }
        
        .image-box img {
            width: 100%;
            height: auto;
            display: block;
            object-fit: cover;
        }
        
        /* ç§»åŠ¨ç«¯å¸ƒå±€ */
        @media (max-width: 768px) {
            .image-container {
                flex-direction: column;
            }
            
            .image-box {
                min-height: 200px;
            }
        }
        
        /* ==================== åŠ è½½åŠ¨ç”» ==================== */
        #loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }
        
        #loading-overlay.active {
            display: flex;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border-color);
            border-top-color: var(--secondary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ==================== é¡µè„š ==================== */
        .page-footer {
            margin-top: var(--spacing-xl);
            padding-top: var(--spacing-lg);
            border-top: 1px solid var(--border-color);
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .contact-info {
            margin-top: var(--spacing-sm);
        }
        
        .contact-info a {
            color: var(--secondary-color);
            text-decoration: none;
        }
        
        .contact-info a:hover {
            text-decoration: underline;
        }
        
        /* ==================== æç¤ºæ¡† ==================== */
        .alert {
            padding: var(--spacing-md);
            border-radius: var(--radius-sm);
            margin-bottom: var(--spacing-md);
            border-left: 4px solid;
        }
        
        .alert-info {
            background: #E8F4F8;
            border-color: var(--secondary-color);
            color: #2C3E50;
        }
        
        .alert-warning {
            background: #FFF3CD;
            border-color: var(--warning-color);
            color: #856404;
        }
        
        /* ==================== å“åº”å¼è®¾è®¡ ==================== */
        @media (max-width: 768px) {
            #app {
                padding: var(--spacing-sm);
            }
            
            .page {
                padding: var(--spacing-md);
            }
            
            .page-title {
                font-size: 1.5rem;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .logo {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
        }
        
        /* ==================== æ‰“å°æ ·å¼ ==================== */
        @media print {
            body {
                background: white;
            }
            
            .btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- åŠ è½½é®ç½© -->
    <div id="loading-overlay">
        <div class="spinner"></div>
    </div>

    <!-- ä¸»åº”ç”¨å®¹å™¨ -->
    <div id="app">
        <!-- ==================== é¡µé¢1ï¼šæ¬¢è¿/çŸ¥æƒ…åŒæ„ ==================== -->
        <div id="page-welcome" class="page active">
            <div class="page-header">
                <div class="logo">ğŸ™ï¸</div>
                <h1 class="page-title">åŸå¸‚ç©ºé—´å®‰å…¨æ„ŸçŸ¥ç ”ç©¶</h1>
                <p class="page-subtitle">è¥¿åŒ—å¤§å­¦äººåœ°å…³ç³»ä¸ç©ºé—´å®‰å…¨ç‰¹è‰²ä¼˜åŠ¿ç§‘ç ”å›¢é˜Ÿ</p>
            </div>
            
            <div class="content">
                <div class="content-section">
                    <h3>ç ”ç©¶ç®€ä»‹</h3>
                    <p>æœ¬ç ”ç©¶æ—¨åœ¨äº†è§£å…¬ä¼—å¯¹åŸå¸‚è¡—é“ç©ºé—´ä¸­ä½é¾„å„¿ç«¥ï¼ˆ0-6å²ï¼‰"æ˜“å¤±è¸ª"é£é™©çš„æ„ŸçŸ¥ã€‚é€šè¿‡æ”¶é›†æ‚¨å¯¹ä¸åŒè¡—é“ç¯å¢ƒçš„ä¸»è§‚åˆ¤æ–­ï¼Œæˆ‘ä»¬å¸Œæœ›è¯†åˆ«å‡ºå“ªäº›ç©ºé—´ç‰¹å¾ä¼šå½±å“å„¿ç«¥å®‰å…¨ï¼Œä¸ºåŸå¸‚è§„åˆ’å’Œå„¿ç«¥ä¿æŠ¤æä¾›ç§‘å­¦ä¾æ®ã€‚</p>
                </div>
                
                <div class="content-section">
                    <h3>ä»»åŠ¡è¯´æ˜</h3>
                    <p>æœ¬ç ”ç©¶é‡‡ç”¨å›¾ç‰‡é…å¯¹æ¯”è¾ƒçš„æ–¹å¼è¿›è¡Œã€‚æ‚¨å°†çœ‹åˆ°æˆå¯¹çš„è¡—é“å›¾ç‰‡ï¼Œè¯·æ ¹æ®æ‚¨çš„ç›´è§‰å’Œç»éªŒï¼Œåˆ¤æ–­å“ªä¸€ä¸ªè¡—é“ç¯å¢ƒæ›´å®¹æ˜“ä½¿ä½é¾„å„¿ç«¥å¤±è¸ªã€‚</p>
                    <ul>
                        <li>æ¯è½®è¯„ä»·åŒ…å«30ç»„å›¾ç‰‡å¯¹ï¼ˆå¦‚å‰©ä½™ä¸è¶³åˆ™å…¨éƒ¨åˆ†é…ï¼‰</li>
                        <li>æ¯ç»„è¯„ä»·é¢„è®¡è€—æ—¶5-10ç§’</li>
                        <li>å®Œæˆä¸€è½®åå¯é€‰æ‹©ç»§ç»­æˆ–ç»“æŸ</li>
                        <li>é¢„è®¡æ€»æ—¶é•¿ï¼š5-15åˆ†é’Ÿ</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>éšç§æ”¿ç­–ä¸æ•°æ®ä½¿ç”¨</h3>
                    <p>æˆ‘ä»¬é«˜åº¦é‡è§†æ‚¨çš„éšç§ä¿æŠ¤ï¼š</p>
                    <ul>
                        <li>æ‰€æœ‰æ•°æ®é‡‡ç”¨åŒ¿ååŒ–å¤„ç†ï¼Œä¸ä¼šæ”¶é›†ä»»ä½•å¯è¯†åˆ«ä¸ªäººèº«ä»½çš„ä¿¡æ¯</li>
                        <li>æ”¶é›†çš„æ•°æ®ä»…ç”¨äºå­¦æœ¯ç ”ç©¶ï¼Œä¸ä¼šç”¨äºå•†ä¸šç”¨é€”</li>
                        <li>ç ”ç©¶ç»“æœå°†ä»¥èšåˆå½¢å¼å‘å¸ƒï¼Œä¸ä¼šæ³„éœ²ä¸ªäººæ•°æ®</li>
                        <li>æ‚¨æœ‰æƒéšæ—¶é€€å‡ºç ”ç©¶ï¼Œå·²æäº¤çš„æ•°æ®å°†è¢«åˆ é™¤</li>
                    </ul>
                </div>
                
                <div class="alert alert-info">
                    <strong>çŸ¥æƒ…åŒæ„ï¼š</strong>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å³è¡¨ç¤ºæ‚¨å·²é˜…è¯»å¹¶ç†è§£ä¸Šè¿°å†…å®¹ï¼Œè‡ªæ„¿å‚ä¸æœ¬ç ”ç©¶ã€‚
                </div>
            </div>
            
            <button id="btn-agree" class="btn btn-primary btn-block">âœ“ æˆ‘å·²äº†è§£å¹¶åŒæ„å‚ä¸</button>
            
            <div class="page-footer">
                <p>è¥¿åŒ—å¤§å­¦äººåœ°å…³ç³»ä¸ç©ºé—´å®‰å…¨ç‰¹è‰²ä¼˜åŠ¿ç§‘ç ”å›¢é˜Ÿ</p>
                <p class="contact-info">è”ç³»æˆ‘ä»¬ï¼š<a href="mailto:libingcheng3979@163.com">libingcheng3979@163.com</a></p>
            </div>
        </div>

        <!-- ==================== é¡µé¢2ï¼šä¿¡æ¯å¡«å†™ ==================== -->
        <div id="page-info" class="page">
            <div class="page-header">
                <div class="logo">ğŸ“</div>
                <h1 class="page-title">åŸºæœ¬ä¿¡æ¯å¡«å†™</h1>
                <p class="page-subtitle">è¯·å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼ˆæ ‡*ä¸ºå¿…å¡«é¡¹ï¼‰</p>
            </div>
            
            <form id="form-participant">
                <div class="form-group">
                    <label class="form-label required">æ€§åˆ«</label>
                    <select class="form-control" id="gender" required>
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="ç”·">ç”·</option>
                        <option value="å¥³">å¥³</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label required">å¹´é¾„æ®µ</label>
                    <select class="form-control" id="age_group" required>
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="18-25å²">18-25å²</option>
                        <option value="26-35å²">26-35å²</option>
                        <option value="36-45å²">36-45å²</option>
                        <option value="46å²ä»¥ä¸Š">46å²ä»¥ä¸Š</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label required">æ˜¯å¦æœ‰ä½é¾„å„¿ç«¥ï¼ˆ0-6å²ï¼‰é™ªæŠ¤ç»éªŒ</label>
                    <select class="form-control" id="child_care_experience" required>
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="true">æ˜¯</option>
                        <option value="false">å¦</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label required">é™ªæŠ¤ç»éªŒå¹´é™</label>
                    <select class="form-control" id="care_years" required>
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="<1å¹´">å°‘äº1å¹´</option>
                        <option value="1-3å¹´">1-3å¹´</option>
                        <option value="3-5å¹´">3-5å¹´</option>
                        <option value=">5å¹´">5å¹´ä»¥ä¸Š</option>
                    </select>
                </div>
                
                <div class="content-section">
                    <h3>é€‰å¡«ä¿¡æ¯</h3>
                    <p style="font-size: 0.9rem; color: var(--text-secondary);">ä»¥ä¸‹ä¿¡æ¯ä¸ºå¯é€‰é¡¹ï¼Œå¡«å†™æœ‰åŠ©äºæˆ‘ä»¬æ›´å¥½åœ°åˆ†ææ•°æ®</p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">æ•™è‚²æ°´å¹³</label>
                    <select class="form-control" id="education_level">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="é«˜ä¸­åŠä»¥ä¸‹">é«˜ä¸­åŠä»¥ä¸‹</option>
                        <option value="å¤§ä¸“/æœ¬ç§‘">å¤§ä¸“/æœ¬ç§‘</option>
                        <option value="ç¡•å£«">ç¡•å£«</option>
                        <option value="åšå£«åŠä»¥ä¸Š">åšå£«åŠä»¥ä¸Š</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">æ˜¯å¦å¸¸é©»è¥¿å®‰</label>
                    <select class="form-control" id="residence_area">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="æ˜¯">æ˜¯</option>
                        <option value="å¦">å¦</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ä¸é™ªæŠ¤å„¿ç«¥çš„å…³ç³»</label>
                    <select class="form-control" id="relation_with_child">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="çˆ¶æ¯">çˆ¶æ¯</option>
                        <option value="ç¥–çˆ¶æ¯">ç¥–çˆ¶æ¯</option>
                        <option value="è€å¸ˆ">è€å¸ˆ</option>
                        <option value="ä¿å§†">ä¿å§†</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                </div>
            </form>
            
            <button id="btn-submit-info" class="btn btn-primary btn-block">æäº¤å¹¶ç»§ç»­</button>
        </div>

        <!-- ==================== é¡µé¢3ï¼šå®éªŒè¯´æ˜ ==================== -->
        <div id="page-instruction" class="page">
            <div class="page-header">
                <div class="logo">ğŸ’¡</div>
                <h1 class="page-title">å®éªŒè¯´æ˜</h1>
                <p class="page-subtitle">è¯·ä»”ç»†é˜…è¯»ä»¥ä¸‹å†…å®¹</p>
            </div>
            
            <div class="content">
                <div class="content-section">
                    <h3>ç ”ç©¶ç›®çš„</h3>
                    <p>æœ¬ç ”ç©¶æ—¨åœ¨æ”¶é›†æ‚¨å¯¹åŸå¸‚è¡—é“ç©ºé—´çš„å®‰å…¨æ„ŸçŸ¥ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹ä½é¾„å„¿ç«¥ï¼ˆ0-6å²ï¼‰å¯èƒ½é¢ä¸´çš„èµ°å¤±é£é™©ã€‚æ‚¨çš„åˆ¤æ–­å°†å¸®åŠ©æˆ‘ä»¬è¯†åˆ«å“ªäº›ç©ºé—´ç‰¹å¾ä¼šå½±å“å„¿ç«¥å®‰å…¨ã€‚</p>
                </div>
                
                <div class="content-section">
                    <h3>è¯„ä»·æ–¹æ³•</h3>
                    <p>æ‚¨å°†çœ‹åˆ°ä¸¤å¼ è¡—é“ç¯å¢ƒçš„å®æ™¯ç…§ç‰‡ï¼Œè¯·æ ¹æ®ä»¥ä¸‹æ ‡å‡†è¿›è¡Œåˆ¤æ–­ï¼š</p>
                    <ul>
                        <li><strong>æƒ³è±¡åœºæ™¯ï¼š</strong>å‡è®¾ä¸€åä½é¾„å„¿ç«¥ï¼ˆ0-6å²ï¼‰ç‹¬è‡ªå‡ºç°åœ¨è¯¥è¡—é“ç¯å¢ƒä¸­</li>
                        <li><strong>è¯„ä»·æ ‡å‡†ï¼š</strong>å“ªä¸ªç¯å¢ƒæ›´å®¹æ˜“å¯¼è‡´å„¿ç«¥èµ°å¤±æˆ–å¤±è¸ªï¼Ÿ</li>
                        <li><strong>è€ƒè™‘å› ç´ ï¼š</strong>äººæµå¯†åº¦ã€è§†çº¿é®æŒ¡ã€ç©ºé—´å¤æ‚åº¦ã€ç›‘æ§å¯èƒ½æ€§ç­‰</li>
                        <li><strong>ç›´è§‰åˆ¤æ–­ï¼š</strong>è¯·æ ¹æ®æ‚¨çš„ç¬¬ä¸€å°è±¡å’Œç»éªŒå¿«é€Ÿåšå‡ºé€‰æ‹©</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>æ“ä½œæµç¨‹</h3>
                    <ul>
                        <li>æ¯æ¬¡æ˜¾ç¤ºä¸€å¯¹è¡—é“å›¾ç‰‡ï¼ˆå·¦å³æˆ–ä¸Šä¸‹æ’åˆ—ï¼‰</li>
                        <li>ä»”ç»†è§‚å¯Ÿä¸¤å¼ å›¾ç‰‡åï¼Œç‚¹å‡»æ‚¨è®¤ä¸º"æ›´å®¹æ˜“ä½¿å„¿ç«¥å¤±è¸ª"çš„å›¾ç‰‡</li>
                        <li>æ¯ç»„è¯„ä»·è‡³å°‘åœç•™1ç§’ï¼Œè¯·å‹¿è¿‡å¿«ç‚¹å‡»</li>
                        <li>å®Œæˆ30ç»„åå¯é€‰æ‹©ç»§ç»­æˆ–ç»“æŸå®éªŒ</li>
                    </ul>
                </div>
                
                <div class="alert alert-warning">
                    <strong>æ³¨æ„äº‹é¡¹ï¼š</strong>
                    <ul style="margin: 0.5rem 0 0 0; padding-left: 1.2rem;">
                        <li>æ²¡æœ‰æ­£ç¡®ç­”æ¡ˆï¼Œè¯·æ ¹æ®æ‚¨çš„çœŸå®æ„Ÿå—åˆ¤æ–­</li>
                        <li>æ¯ç»„è‡³å°‘è§‚å¯Ÿ1ç§’å†åšé€‰æ‹©</li>
                        <li>å¦‚é‡åˆ°å›¾ç‰‡åŠ è½½æ…¢ï¼Œè¯·è€å¿ƒç­‰å¾…</li>
                        <li>å®éªŒè¿‡ç¨‹ä¸­è¯·å‹¿åˆ·æ–°é¡µé¢</li>
                    </ul>
                </div>
            </div>
            
            <button id="btn-start-experiment" class="btn btn-primary btn-block">å¼€å§‹å®éªŒ â†’</button>
        </div>

        <!-- ==================== é¡µé¢4ï¼šå›¾ç‰‡æ¯”è¾ƒ ==================== -->
        <div id="page-comparison" class="page">
            <div class="progress-bar">
                <div class="progress-text">
                    è¿›åº¦ï¼š<span class="progress-numbers"><span id="current-index">1</span> / <span id="total-count">30</span></span>
                </div>
            </div>
            
            <div class="prompt">
                è¯·åˆ¤æ–­å“ªä¸€ä¸ªè¡—é“ç¯å¢ƒæ›´å®¹æ˜“ä½¿ä½é¾„å„¿ç«¥ï¼ˆ0-6å²ï¼‰å¤±è¸ªï¼Ÿ
            </div>
            
            <div class="image-container">
                <div class="image-box" id="left-image" data-choice="left">
                    <img id="img-left" src="" alt="è¡—é“ç¯å¢ƒA">
                </div>
                <div class="image-box" id="right-image" data-choice="right">
                    <img id="img-right" src="" alt="è¡—é“ç¯å¢ƒB">
                </div>
            </div>
        </div>

        <!-- ==================== é¡µé¢5ï¼šåé¦ˆé¡µ ==================== -->
        <div id="page-feedback" class="page">
            <div class="page-header">
                <div class="logo">ğŸ‰</div>
                <h1 class="page-title">æ„Ÿè°¢æ‚¨çš„å‚ä¸ï¼</h1>
                <p class="page-subtitle">æ‚¨å·²å®Œæˆæœ¬è½®è¯„ä»·</p>
            </div>
            
            <div class="content">
                <div class="content-section">
                    <h3>ä½“éªŒåé¦ˆ</h3>
                    <p>æˆ‘ä»¬éå¸¸é‡è§†æ‚¨çš„æ„è§å’Œå»ºè®®ï¼Œè¯·åˆ†äº«æ‚¨çš„ä½¿ç”¨ä½“éªŒï¼ˆé€‰å¡«ï¼Œæœ€å¤š50å­—ï¼‰ï¼š</p>
                </div>
                
                <div class="form-group">
                    <textarea id="feedback-text" class="form-control" maxlength="50" 
                              placeholder="ä¾‹å¦‚ï¼šå›¾ç‰‡åŠ è½½é€Ÿåº¦ã€æ“ä½œæµç•…åº¦ã€å»ºè®®æ”¹è¿›ä¹‹å¤„..."></textarea>
                    <div class="char-count"><span id="char-count">0</span> / 50</div>
                </div>
                
                <div class="alert alert-info">
                    æ‚¨å¯ä»¥é€‰æ‹©ç»§ç»­å‚ä¸æ›´å¤šè¯„ä»·ï¼Œæˆ–ç»“æŸæœ¬æ¬¡å®éªŒã€‚æ„Ÿè°¢æ‚¨çš„å®è´µæ—¶é—´ï¼
                </div>
            </div>
            
            <div class="button-group">
                <button id="btn-continue" class="btn btn-primary">ç»§ç»­å®éªŒ</button>
                <button id="btn-finish" class="btn btn-secondary">ç»“æŸå®éªŒ</button>
            </div>
        </div>

        <!-- ==================== é¡µé¢6ï¼šæ„Ÿè°¢é¡µ ==================== -->
        <div id="page-thanks" class="page">
            <div class="page-header">
                <div class="logo">âœ¨</div>
                <h1 class="page-title">å®éªŒå®Œæˆï¼</h1>
                <p class="page-subtitle">æ„Ÿè°¢æ‚¨å¯¹åŸå¸‚å®‰å…¨ç ”ç©¶çš„æ”¯æŒ</p>
            </div>
            
            <div class="content">
                <div class="content-section">
                    <h3>è¡·å¿ƒæ„Ÿè°¢</h3>
                    <p>æ‚¨çš„å‚ä¸å¯¹æˆ‘ä»¬çš„ç ”ç©¶è‡³å…³é‡è¦ã€‚é€šè¿‡æ”¶é›†åƒæ‚¨è¿™æ ·çš„å…¬ä¼—æ„ŸçŸ¥æ•°æ®ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£åŸå¸‚ç©ºé—´ç‰¹å¾ä¸å„¿ç«¥å®‰å…¨çš„å…³ç³»ï¼Œä¸ºåŸå¸‚è§„åˆ’å’Œå„¿ç«¥ä¿æŠ¤æ”¿ç­–æä¾›ç§‘å­¦ä¾æ®ã€‚</p>
                </div>
                
                <div class="content-section">
                    <h3>æ•°æ®ä½¿ç”¨</h3>
                    <p>æ‚¨æäº¤çš„æ•°æ®å·²å®‰å…¨ä¿å­˜ï¼Œå°†ç”¨äºï¼š</p>
                    <ul>
                        <li>è®¡ç®—è¡—é“ç©ºé—´çš„é£é™©æ„ŸçŸ¥è¯„åˆ†</li>
                        <li>è®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹è¯†åˆ«é«˜é£é™©ç©ºé—´ç‰¹å¾</li>
                        <li>å‘è¡¨å­¦æœ¯è®ºæ–‡ï¼Œæ¨åŠ¨åŸå¸‚å®‰å…¨ç ”ç©¶</li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <h3>ä¿æŒè”ç³»</h3>
                    <p>å¦‚æœæ‚¨å¯¹ç ”ç©¶ç»“æœæ„Ÿå…´è¶£ï¼Œæˆ–æœ‰ä»»ä½•é—®é¢˜å’Œå»ºè®®ï¼Œæ¬¢è¿é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»æˆ‘ä»¬ï¼š</p>
                    <p style="text-align: center; margin-top: 1rem;">
                        <strong>è¥¿åŒ—å¤§å­¦äººåœ°å…³ç³»ä¸ç©ºé—´å®‰å…¨ç‰¹è‰²ä¼˜åŠ¿ç§‘ç ”å›¢é˜Ÿ</strong><br>
                        <a href="mailto:libingcheng3979@163.com" style="color: var(--secondary-color); text-decoration: none;">
                            ğŸ“® libingcheng3979@163.com
                        </a>
                    </p>
                </div>
            </div>
            
            <div class="page-footer" style="margin-top: 2rem;">
                <p>Â© 2025 è¥¿åŒ—å¤§å­¦äººåœ°å…³ç³»ä¸ç©ºé—´å®‰å…¨ç‰¹è‰²ä¼˜åŠ¿ç§‘ç ”å›¢é˜Ÿ</p>
                <p style="margin-top: 0.5rem; font-size: 0.8rem;">æœ¬å¹³å°æ•°æ®å—éšç§ä¿æŠ¤ï¼Œä»…ç”¨äºå­¦æœ¯ç ”ç©¶</p>
            </div>
        </div>
    </div>

    <!-- ==================== JavaScript ä»£ç  ==================== -->
    <script>
        // ==================== é…ç½®ä¸åˆå§‹åŒ– ====================
        
        // LeanCloud é…ç½®
        const LEANCLOUD_CONFIG = {
            appId: 'uzZcqNVUEsS5NHf82r0QJRdR-gzGzoHsz',
            appKey: 'VavvdrQPWVEjweyMAYgOSNat',
            serverURL: 'https://uzzcqnvu.lc-cn-n1-shared.com'  // è¯·æ›¿æ¢ä¸ºå®é™… serverURL
        };
        
        // åˆå§‹åŒ– LeanCloud SDK
        AV.init(LEANCLOUD_CONFIG);
        
        // å…¨å±€çŠ¶æ€ç®¡ç†
        const appState = {
            participantId: localStorage.getItem('participant_id') || null,
            roundId: null,
            currentTasks: [],
            currentTaskIndex: 0,
            startTime: null,
            isSubmitting: false,
            preloadedImages: {}
        };
        
        // ==================== å·¥å…·å‡½æ•° ====================
        
        /**
         * ç”Ÿæˆ UUID
         */
        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }
        
        /**
         * è·å–è®¾å¤‡ä¿¡æ¯
         */
        function getDeviceInfo() {
            const ua = navigator.userAgent;
            let deviceType = 'Desktop';
            
            if (/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua)) {
                deviceType = 'Tablet';
            } else if (/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(ua)) {
                deviceType = 'Mobile';
            }
            
            return {
                type: deviceType,
                userAgent: ua
            };
        }
        
        /**
         * è·å– IP åœ°å€ï¼ˆä½¿ç”¨ç¬¬ä¸‰æ–¹ APIï¼‰
         */
        async function getIPAddress() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                console.error('è·å–IPå¤±è´¥:', error);
                return 'unknown';
            }
        }
        
        /**
         * æ˜¾ç¤º/éšè—åŠ è½½åŠ¨ç”»
         */
        function toggleLoading(show) {
            const overlay = document.getElementById('loading-overlay');
            if (show) {
                overlay.classList.add('active');
            } else {
                overlay.classList.remove('active');
            }
        }
        
        /**
         * é¡µé¢å¯¼èˆª
         */
        function showPage(pageId) {
            // éšè—æ‰€æœ‰é¡µé¢
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // æ˜¾ç¤ºç›®æ ‡é¡µé¢
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
                window.scrollTo(0, 0);
            }
        }
        
        /**
         * æ˜¾ç¤ºæç¤ºä¿¡æ¯
         */
        function showAlert(message, type = 'info') {
            alert(message);  // ç®€å•å®ç°ï¼Œå¯ä»¥åç»­ä¼˜åŒ–ä¸ºæ›´ä¼˜é›…çš„æç¤ºæ¡†
        }
        
        /**
         * é¢„åŠ è½½å›¾ç‰‡
         */
        function preloadImage(url) {
            return new Promise((resolve, reject) => {
                if (appState.preloadedImages[url]) {
                    resolve(url);
                    return;
                }
                
                const img = new Image();
                img.onload = () => {
                    appState.preloadedImages[url] = true;
                    resolve(url);
                };
                img.onerror = () => {
                    reject(new Error(`å›¾ç‰‡åŠ è½½å¤±è´¥: ${url}`));
                };
                img.src = url;
            });
        }
        
        // ==================== é¡µé¢1ï¼šæ¬¢è¿é¡µ ====================
        
        document.getElementById('btn-agree').addEventListener('click', function() {
            showPage('page-info');
        });
        
        // ==================== é¡µé¢2ï¼šä¿¡æ¯å¡«å†™ ====================
        
        document.getElementById('btn-submit-info').addEventListener('click', async function() {
            const form = document.getElementById('form-participant');
            
            // éªŒè¯å¿…å¡«å­—æ®µ
            if (!form.checkValidity()) {
                showAlert('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹ï¼ˆæ ‡*çš„å­—æ®µï¼‰');
                form.reportValidity();
                return;
            }
            
            // æ”¶é›†è¡¨å•æ•°æ®
            const formData = {
                gender: document.getElementById('gender').value,
                age_group: document.getElementById('age_group').value,
                child_care_experience: document.getElementById('child_care_experience').value === 'true',
                care_years: document.getElementById('care_years').value,
                education_level: document.getElementById('education_level').value || null,
                residence_area: document.getElementById('residence_area').value || null,
                relation_with_child: document.getElementById('relation_with_child').value || null
            };
            
            // è·å–è®¾å¤‡ä¿¡æ¯
            const deviceInfo = getDeviceInfo();
            formData.device_type = deviceInfo.type;
            formData.user_agent = deviceInfo.userAgent;
            
            // è·å– IP åœ°å€
            toggleLoading(true);
            formData.ip_address = await getIPAddress();
            
            try {
                // è°ƒç”¨äº‘å‡½æ•°åˆ›å»ºå‚ä¸è€…
                const result = await AV.Cloud.run('createParticipant', formData);
                
                if (result.success) {
                    // ä¿å­˜ participant_id
                    appState.participantId = result.participant_id;
                    localStorage.setItem('participant_id', result.participant_id);
                    
                    // è¿›å…¥å®éªŒè¯´æ˜é¡µ
                    showPage('page-instruction');
                } else {
                    showAlert('æäº¤å¤±è´¥ï¼š' + result.error);
                }
            } catch (error) {
                console.error('æäº¤å‚ä¸è€…ä¿¡æ¯å¤±è´¥:', error);
                showAlert('ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•');
            } finally {
                toggleLoading(false);
            }
        });
        
        // ==================== é¡µé¢3ï¼šå®éªŒè¯´æ˜ ====================
        
        document.getElementById('btn-start-experiment').addEventListener('click', async function() {
            await loadNewRound();
        });
        
        // ==================== é¡µé¢4ï¼šå›¾ç‰‡æ¯”è¾ƒ ====================
        
        /**
         * åŠ è½½æ–°ä¸€è½®ä»»åŠ¡
         */
        async function loadNewRound() {
            toggleLoading(true);
            
            try {
                // ç”Ÿæˆæ–°çš„ round_id
                appState.roundId = generateUUID();
                
                // è°ƒç”¨äº‘å‡½æ•°è·å–é…å¯¹ä»»åŠ¡
                const result = await AV.Cloud.run('getPairTasks', { count: 30 });
                
                if (result.success && result.tasks.length > 0) {
                    appState.currentTasks = result.tasks;
                    appState.currentTaskIndex = 0;
                    
                    // æ˜¾ç¤ºç¬¬ä¸€ç»„
                    showPage('page-comparison');
                    await showNextPair();
                } else {
                    // æ²¡æœ‰å¯ç”¨ä»»åŠ¡äº†
                    showAlert('æ‰€æœ‰è¯„ä»·ä»»åŠ¡å·²å®Œæˆï¼Œæ„Ÿè°¢æ‚¨çš„å‚ä¸ï¼');
                    showPage('page-thanks');
                }
            } catch (error) {
                console.error('åŠ è½½ä»»åŠ¡å¤±è´¥:', error);
                showAlert('åŠ è½½ä»»åŠ¡å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•');
            } finally {
                toggleLoading(false);
            }
        }
        
        /**
         * æ˜¾ç¤ºä¸‹ä¸€ç»„å›¾ç‰‡å¯¹
         */
        async function showNextPair() {
            if (appState.currentTaskIndex >= appState.currentTasks.length) {
                // æœ¬è½®å®Œæˆ
                showPage('page-feedback');
                return;
            }
            
            const task = appState.currentTasks[appState.currentTaskIndex];
            
            // æ›´æ–°è¿›åº¦
            document.getElementById('current-index').textContent = appState.currentTaskIndex + 1;
            document.getElementById('total-count').textContent = appState.currentTasks.length;
            
            // éšæœºåˆ†é…å·¦å³ä½ç½®
            const randomPosition = Math.random() < 0.5;
            const leftUrl = randomPosition ? task.left_image_url : task.right_image_url;
            const rightUrl = randomPosition ? task.right_image_url : task.left_image_url;
            const leftPid = randomPosition ? task.left_image_pid : task.right_image_pid;
            const rightPid = randomPosition ? task.right_image_pid : task.left_image_pid;
            
            // ä¿å­˜å½“å‰ä»»åŠ¡ä¿¡æ¯ï¼ˆç”¨äºæäº¤ï¼‰
            appState.currentTask = {
                pair_id: task.pair_id,
                left_image_pid: leftPid,
                right_image_pid: rightPid,
                left_url: leftUrl,
                right_url: rightUrl
            };
            
            // ç¦ç”¨ç‚¹å‡»
            const leftBox = document.getElementById('left-image');
            const rightBox = document.getElementById('right-image');
            leftBox.classList.add('disabled');
            rightBox.classList.add('disabled');
            
            try {
                // é¢„åŠ è½½å½“å‰å’Œä¸‹ä¸€ç»„å›¾ç‰‡
                toggleLoading(true);
                await Promise.all([
                    preloadImage(leftUrl),
                    preloadImage(rightUrl)
                ]);
                
                // æ˜¾ç¤ºå›¾ç‰‡
                document.getElementById('img-left').src = leftUrl;
                document.getElementById('img-right').src = rightUrl;
                
                // é¢„åŠ è½½ä¸‹ä¸€ç»„
                if (appState.currentTaskIndex + 1 < appState.currentTasks.length) {
                    const nextTask = appState.currentTasks[appState.currentTaskIndex + 1];
                    preloadImage(nextTask.left_image_url);
                    preloadImage(nextTask.right_image_url);
                }
                
                // è®°å½•å¼€å§‹æ—¶é—´
                appState.startTime = Date.now();
                
                // å¯ç”¨ç‚¹å‡»ï¼ˆå»¶è¿Ÿ1ç§’ï¼‰
                setTimeout(() => {
                    leftBox.classList.remove('disabled');
                    rightBox.classList.remove('disabled');
                }, 1000);
                
            } catch (error) {
                console.error('å›¾ç‰‡åŠ è½½å¤±è´¥:', error);
                showAlert('å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
            } finally {
                toggleLoading(false);
            }
        }
        
        /**
         * å¤„ç†å›¾ç‰‡é€‰æ‹©
         */
        async function handleImageChoice(choice) {
            if (appState.isSubmitting) return;
            
            // è®¡ç®—å“åº”æ—¶é—´
            const responseTime = Date.now() - appState.startTime;
            
            // éªŒè¯è‡³å°‘åœç•™1ç§’
            if (responseTime < 1000) {
                showAlert('è¯·ä»”ç»†è§‚å¯Ÿå›¾ç‰‡åå†åšé€‰æ‹©ï¼ˆè‡³å°‘åœç•™1ç§’ï¼‰');
                return;
            }
            
            appState.isSubmitting = true;
            
            // ç¦ç”¨ç‚¹å‡»
            document.getElementById('left-image').classList.add('disabled');
            document.getElementById('right-image').classList.add('disabled');
            
            // ç¡®å®šé€‰ä¸­çš„å›¾ç‰‡
            const chosenPid = choice === 'left' 
                ? appState.currentTask.left_image_pid 
                : appState.currentTask.right_image_pid;
            
            // æ„å»ºæŠ•ç¥¨æ•°æ®
            const voteData = {
                round_id: appState.roundId,
                participant_id: appState.participantId,
                pair_id: appState.currentTask.pair_id,
                pair_index: appState.currentTaskIndex,
                left_image_pid: appState.currentTask.left_image_pid,
                right_image_pid: appState.currentTask.right_image_pid,
                user_choice: choice,
                chosen_image_pid: chosenPid,
                response_time_ms: responseTime,
                choice_timestamp: new Date().toISOString(),
                abnormal_flag: false
            };
            
            try {
                // æäº¤æŠ•ç¥¨
                const result = await AV.Cloud.run('submitVote', voteData);
                
                if (result.success) {
                    // è¿›å…¥ä¸‹ä¸€ç»„
                    appState.currentTaskIndex++;
                    await showNextPair();
                } else {
                    showAlert('æäº¤å¤±è´¥ï¼š' + result.error);
                }
            } catch (error) {
                console.error('æäº¤æŠ•ç¥¨å¤±è´¥:', error);
                showAlert('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•');
            } finally {
                appState.isSubmitting = false;
            }
        }
        
        // ç»‘å®šå›¾ç‰‡ç‚¹å‡»äº‹ä»¶
        document.getElementById('left-image').addEventListener('click', function() {
            if (!this.classList.contains('disabled')) {
                handleImageChoice('left');
            }
        });
        
        document.getElementById('right-image').addEventListener('click', function() {
            if (!this.classList.contains('disabled')) {
                handleImageChoice('right');
            }
        });
        
        // ==================== é¡µé¢5ï¼šåé¦ˆé¡µ ====================
        
        // å­—ç¬¦è®¡æ•°
        document.getElementById('feedback-text').addEventListener('input', function() {
            document.getElementById('char-count').textContent = this.value.length;
        });
        
        // ç»§ç»­å®éªŒ
        document.getElementById('btn-continue').addEventListener('click', async function() {
            // å…ˆæäº¤åé¦ˆï¼ˆå¦‚æœæœ‰ï¼‰
            const feedback = document.getElementById('feedback-text').value.trim();
            if (feedback) {
                await submitFeedback(feedback);
            }
            
            // æ¸…ç©ºåé¦ˆæ¡†
            document.getElementById('feedback-text').value = '';
            document.getElementById('char-count').textContent = '0';
            
            // åŠ è½½æ–°ä¸€è½®
            await loadNewRound();
        });
        
        // ç»“æŸå®éªŒ
        document.getElementById('btn-finish').addEventListener('click', async function() {
            // æäº¤åé¦ˆï¼ˆå¦‚æœæœ‰ï¼‰
            const feedback = document.getElementById('feedback-text').value.trim();
            if (feedback) {
                toggleLoading(true);
                await submitFeedback(feedback);
                toggleLoading(false);
            }
            
            // æ˜¾ç¤ºæ„Ÿè°¢é¡µ
            showPage('page-thanks');
        });
        
        /**
         * æäº¤ç”¨æˆ·åé¦ˆ
         */
        async function submitFeedback(feedback) {
            if (!feedback || feedback.length === 0) return;
            
            try {
                const result = await AV.Cloud.run('submitFeedback', {
                    participant_id: appState.participantId,
                    user_feedback: feedback
                });
                
                if (!result.success) {
                    console.error('åé¦ˆæäº¤å¤±è´¥:', result.error);
                }
            } catch (error) {
                console.error('æäº¤åé¦ˆå¤±è´¥:', error);
            }
        }
        
        // ==================== åº”ç”¨åˆå§‹åŒ– ====================
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('åŸå¸‚ç©ºé—´å®‰å…¨æ„ŸçŸ¥ç ”ç©¶å¹³å°å·²åŠ è½½');
            console.log('å‚ä¸è€…ID:', appState.participantId || 'æœªåˆ†é…');
            
            // å¦‚æœç”¨æˆ·åˆ·æ–°é¡µé¢ï¼Œä»å¤´å¼€å§‹
            // ï¼ˆæ ¹æ®éœ€æ±‚ï¼Œä¸ä¿ç•™å†å²è¿›åº¦ï¼‰
        });
        
        // é˜»æ­¢é¡µé¢åˆ·æ–°æ—¶çš„è­¦å‘Šï¼ˆå¯é€‰ï¼‰
        window.addEventListener('beforeunload', function(e) {
            if (appState.currentTaskIndex > 0 && appState.currentTaskIndex < appState.currentTasks.length) {
                e.preventDefault();
                e.returnValue = 'æ‚¨å½“å‰çš„è¿›åº¦å°†ä¼šä¸¢å¤±ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ';
            }
        });
    </script>
</body>
</html>